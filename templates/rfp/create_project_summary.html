{% extends 'base.html' %}
{% load user_extras %}

{% block title %}Edit {{ project.name }} {% endblock %}

{% block body_block %}
<div class="container">
<!--Project Header-->
{% include 'rfp/project/project_header.html' %}

<!--
<div class="alert alert-success" role="alert">
    <p style="text-align:center">
        Your project has been succesfully submitted.
        You will recieve a confirmation email soon at this address: {{ user.email }}.
        Click <a href="#" onclick="window.print();return false;">here</a> to print this page.
    </p>
</div>

<div class="alert alert-info" role="alert">
    <p style="text-align:center">You can edit your project until the deadline.</p>
</div>
-->

<div class="col-xs-12 col-md-2">


</div>
<div class="col-xs-12 col-md-8">
 <a href="{% url 'create_project_previous' project.pk %}" class="center btn btn-apply" style="width:350px;margin:Auto; padding:15px 15px 15px 15px;">
        Click here to go back and edit your project
    </a>
<a href="#" class="center btn btn-apply" style="width:350px;margin:Auto; padding:15px 15px 15px 15px;" data-toggle="modal" data-target="#myModal">
        Click here to Submit your Project
</a>



<!--
    <a href="{% url 'user_profile' %}?block=proj" class="center btn btn-apply" style="width:350px;margin:Auto; padding:15px 15px 15px 15px;">
            Go to your Projects to follow the review process
    </a>
-->

</div>
<div class="col-xs-12 col-md-2"></div>

<!--Project Details-->
{% include 'rfp/project/project_details.html' %}

<!--Project Budget-->
{% include 'rfp/project/project_budget.html' %}

{% if project.rfp.add_reviewer %}
<!--Reviewer Table-->
    {% include 'rfp/project/project_reviewer.html' %}

{% endif %}

</div>

<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">SUBMIT YOUR PROJECT</h4>
      </div>
      <div class="modal-body">
        <div class="hide" id="ajaxLoader">
            <img src="/static/images/ajax_loader.gif">
        </div>

        <div id="PreSubmitText">
             <p> You are just about to submit your project. You will still be able to edit your project until
            the deadline of the {{  project.rfp.name }} call for proposal: <strong>{{ project.rfp.deadline }}</strong>.
            </p>
             <p> Click Submit to validate your project. After successful submission, you will receive a confirmation email at: {{ project.user.email }}.</p>
        </div>

        <div class="hide" id="PostSubmitText">
             <p>Congratulations, you successfully submitted {{ project.name }} to {{ project.rfp.name }}</p>
             <p>Click <a href="#" data-dismiss="modal">here</a> to close this message.</p>
        </div>

      </div>

      <div class="modal-footer">

          <form id="finalSubmit" method="post">
              <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
              <input  id="project-final-submit" class="save_btn btn btn-primary pull-right" type="submit" value="Save"  />
          </form>

      </div>

    </div>

  </div>
</div>

<script>
    $('.act-link').hide();
    var postedData = $('#finalSubmit').serialize();

    $('#project-final-submit').click(function(){
        $.post({
            url: "{ url 'create_project_summary' project.id %}'",
            data: postedData
         });
        $('#PreSubmitText').addClass('hide');
        $('#PostSubmitText').removeClass('hide');
        $('.modal-footer').hide();

    })

</script>

{% endblock %}